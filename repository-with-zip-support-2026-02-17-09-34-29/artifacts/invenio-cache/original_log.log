 redis Pulling 
 47a60771af96 Pulling fs layer 
 c5761dea9b0e Pulling fs layer 
 4831516dd0cb Pulling fs layer 
 7b28be0c8c4d Pulling fs layer 
 bbf018d6d4b8 Pulling fs layer 
 22dca8215bc4 Pulling fs layer 
 4f4fb700ef54 Pulling fs layer 
 edcaff0d5e7e Pulling fs layer 
 4f4fb700ef54 Already exists 
 47a60771af96 Download complete 
 4831516dd0cb Downloading [======================>                            ]  12.58MB/28.23MB
 7b28be0c8c4d Download complete 
 edcaff0d5e7e Download complete 
 c4cc93acbec6 Download complete 
 c5761dea9b0e Download complete 
 22dca8215bc4 Downloading [=================>                                 ]  5.243MB/15.35MB
 bbf018d6d4b8 Download complete 
 e7da101a9486 Download complete 
 4831516dd0cb Download complete 
 22dca8215bc4 Download complete 
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 4831516dd0cb Extracting 1 s
 47a60771af96 Pull complete 
 7b28be0c8c4d Pull complete 
 edcaff0d5e7e Extracting 1 s
 4831516dd0cb Pull complete 
 edcaff0d5e7e Pull complete 
 22dca8215bc4 Extracting 1 s
 22dca8215bc4 Extracting 1 s
 4f4fb700ef54 Pull complete 
 c5761dea9b0e Pull complete 
 bbf018d6d4b8 Pull complete 
 22dca8215bc4 Pull complete 
 redis Pulled 
 Network docker_services_cli_default  Creating
 Network docker_services_cli_default  Created
 Container docker_services_cli-redis-1  Creating
 Container docker_services_cli-redis-1  Created
 Container docker_services_cli-redis-1  Starting
 Container docker_services_cli-redis-1  Started
============================= test session starts ==============================
platform linux -- Python 3.14.2, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original
configfile: setup.cfg
testpaths: tests, invenio_cache
plugins: mock-3.15.1, isort-4.0.0, flask-1.3.0, black-ng-0.4.1, invenio-3.4.2, github-actions-annotate-failures-0.3.0, pydocstyle-2.4.0, cov-7.0.0, pycodestyle-2.5.0
collected 15 items

tests/test_bccache.py .::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
                                                  [  6%]
tests/test_decorator.py .::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py,line=80::Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py,line=110::Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py,line=118::Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py,line=125::Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
                                               [ 20%]
tests/test_invenio_cache.py ..::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
..                                      [ 66%]
tests/test_locks.py .::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
.::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py,line=55::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
                                                 [ 93%]
invenio_cache/__init__.py .::warning file=/home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
                                              [100%]

=============================== warnings summary ===============================
tests/test_bccache.py: 1 warning
tests/test_decorator.py: 1 warning
tests/test_invenio_cache.py: 5 warnings
tests/test_locks.py: 4 warnings
invenio_cache/__init__.py: 1 warning
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/.venv/lib/python3.14/site-packages/flask_caching/__init__.py:145: DeprecationWarning: Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
    self._set_cache(app, config)

tests/test_decorator.py::test_decorator_cached_with_expiration
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py:80: PytestMockWarning: Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
    with mocker.patch("time.time", return_value=expired):

tests/test_decorator.py::test_decorator_cached_with_expiration
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py:110: PytestMockWarning: Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
    with mocker.patch("time.time", return_value=still_valid):

tests/test_decorator.py::test_decorator_cached_with_expiration
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py:118: PytestMockWarning: Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
    with mocker.patch("time.time", return_value=still_valid_with_entropy):

tests/test_decorator.py::test_decorator_cached_with_expiration
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/tests/test_decorator.py:125: PytestMockWarning: Mocks returned by pytest-mock do not need to be used as context managers. The mocker fixture automatically undoes mocking at the end of a test. This warning can be ignored if it was triggered by mocking a context manager. https://pytest-mock.readthedocs.io/en/latest/usage.html#usage-as-context-manager
    with mocker.patch("time.time", return_value=expired):

tests/test_locks.py::test_cached_mutex
tests/test_locks.py::test_cached_mutex
tests/test_locks.py::test_cached_mutex_context
tests/test_locks.py::test_cached_mutex_context
tests/test_locks.py::test_cached_mutex_context
tests/test_locks.py::test_cached_mutex_context
tests/test_locks.py::test_cached_mutex_renew
tests/test_locks.py::test_cached_mutex_renew
tests/test_locks.py::test_cache_failure
  /home/runner/work/test-zip-extract-repository/test-zip-extract-repository/workdir/tests/invenio-cache/original/invenio_cache/lock.py:55: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._created = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.14.2-final-0 ________________

Name                          Stmts   Miss  Cover   Missing
-----------------------------------------------------------
invenio_cache/__init__.py         7      0   100%
invenio_cache/_compat.py          4      0   100%
invenio_cache/bccache.py          7      0   100%
invenio_cache/config.py           8      0   100%
invenio_cache/decorators.py      46      0   100%
invenio_cache/errors.py          14      1    93%   21
invenio_cache/ext.py             28      0   100%
invenio_cache/lock.py            70     11    84%   70, 80, 84, 88, 92, 157, 206, 214-219, 222
invenio_cache/proxies.py          7      0   100%
-----------------------------------------------------------
TOTAL                           191     12    94%
======================= 15 passed, 25 warnings in 0.55s ========================
 Container docker_services_cli-redis-1  Stopping
 Container docker_services_cli-redis-1  Stopped
 Container docker_services_cli-redis-1  Removing
 Container docker_services_cli-redis-1  Removed
 Network docker_services_cli_default  Removing
 Network docker_services_cli_default  Removed
